# ===========================================
# Docker Compose - Sistema de Restaurantes
# ===========================================
# Uso:
#   Iniciar: docker-compose up -d
#   Detener: docker-compose down
#   Ver logs: docker-compose logs -f postgres
#   Reiniciar: docker-compose restart
# ===========================================

services:
  # ===========================================
  # PostgreSQL Database
  # ===========================================
  postgres:
    image: postgres:15-alpine
    container_name: restaurants_postgres
    restart: unless-stopped
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: Restaurant2024Secure
      POSTGRES_DB: restaurants_db
    ports:
      - "5433:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres -d restaurants_db"]
      interval: 10s
      timeout: 5s
      retries: 5

  # ===========================================
  # pgAdmin (Opcional - Interfaz grafica)
  # ===========================================
  pgadmin:
    image: dpage/pgadmin4:latest
    container_name: restaurants_pgadmin
    restart: unless-stopped
    environment:
      PGADMIN_DEFAULT_EMAIL: admin@restaurant.com
      PGADMIN_DEFAULT_PASSWORD: Admin123!
    ports:
      - "5050:80"
    depends_on:
      - postgres
    volumes:
      - pgadmin_data:/var/lib/pgadmin

# ===========================================
# Volumes persistentes
# ===========================================
volumes:
  postgres_data:
    name: restaurants_postgres_data
  pgadmin_data:
    name: restaurants_pgadmin_data

# ===========================================
# Credenciales de acceso:
# ===========================================
# PostgreSQL:
#   Host: localhost
#   Puerto: 5432
#   Usuario: postgres
#   Password: R3staurant$2024
#   Base de datos: restaurants_db
#
# pgAdmin (http://localhost:5050):
#   Email: admin@restaurant.com
#   Password: Admin123!
# ===========================================
